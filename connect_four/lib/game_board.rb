class GameBoard
    attr_accessor :board, :display, :slots, :turn, :victories
    
    def initialize(first_player)
        @victories = [  [[0,0],[0,1],[0,2],[0,3]],[[0,1],[0,2],[0,3],[0,4]],[[0,2],[0,3],[0,4],[0,5]],
                        [[1,0],[1,1],[1,2],[1,3]],[[1,1],[1,2],[1,3],[1,4]],[[1,2],[1,3],[1,4],[1,5]],
                        [[2,0],[2,1],[2,2],[2,3]],[[2,1],[2,2],[0,3],[2,4]],[[2,2],[2,3],[2,4],[0,5]],
                        [[3,0],[3,1],[3,2],[3,3]],[[3,1],[3,2],[3,3],[3,4]],[[3,2],[3,3],[3,4],[3,5]],
                        [[4,0],[4,1],[4,2],[4,3]],[[4,1],[4,2],[4,3],[4,4]],[[4,2],[4,3],[4,4],[4,5]],
                        [[5,0],[5,1],[5,2],[5,3]],[[5,1],[5,2],[5,3],[5,4]],[[5,2],[5,3],[5,4],[5,5]],
                        [[6,0],[6,1],[6,2],[6,3]],[[6,1],[6,2],[6,3],[6,4]],[[6,2],[6,3],[6,4],[6,5]],
                        [[0,0],[1,0],[2,0],[3,0]],[[1,0],[2,0],[3,0],[4,0]],[[2,0],[3,0],[4,0],[5,0]],[[3,0],[4,0],[5,0],[6,0]],
                        [[0,1],[1,1],[2,1],[3,1]],[[1,1],[2,1],[3,1],[4,1]],[[2,1],[3,1],[4,1],[5,1]],[[3,1],[4,1],[5,1],[6,1]],
                        [[0,2],[1,2],[2,2],[3,2]],[[1,2],[2,2],[3,2],[4,2]],[[2,2],[3,2],[4,2],[5,2]],[[3,2],[4,2],[5,2],[6,2]],
                        [[0,3],[1,3],[2,3],[3,3]],[[1,3],[2,3],[3,3],[4,3]],[[2,3],[3,3],[4,3],[5,3]],[[3,3],[4,3],[5,3],[6,3]],
                        [[0,4],[1,4],[2,4],[3,4]],[[1,4],[2,4],[3,4],[4,4]],[[2,4],[3,4],[4,4],[5,4]],[[3,4],[4,4],[5,4],[6,4]],
                        [[0,5],[1,5],[2,5],[3,5]],[[1,5],[2,5],[3,5],[4,5]],[[2,5],[3,5],[4,5],[5,5]],[[3,5],[4,5],[5,5],[6,5]],
                        [[0,2],[1,3],[2,4],[3,5]],[[0,1],[1,2],[2,3],[3,4]],[[1,2],[2,3],[3,4],[4,5]],
                        [[0,0],[1,1],[2,2],[3,3]],[[1,1],[2,2],[3,3],[4,4]],[[2,2],[3,3],[4,4],[5,5]],
                        [[1,0],[2,1],[3,2],[4,3]],[[2,1],[3,2],[4,3],[5,4]],[[3,2],[4,3],[5,4],[6,5]],
                        [[2,0],[3,1],[4,2],[5,3]],[[3,1],[4,2],[5,3],[6,4]],
                        [[3,0],[4,1],[5,2],[6,3]],
                        [[6,2],[5,3],[4,4],[3,5]],
                        [[6,1],[5,2],[4,3],[3,4]],[[5,2],[4,3],[3,4],[2,5]],
                        [[6,0],[5,1],[4,2],[3,3]],[[5,1],[4,2],[3,3],[2,4]],[[4,2],[3,3],[2,4],[1,5]],
                        [[5,0],[4,1],[3,2],[2,3]],[[4,1],[3,2],[2,3],[1,4]],[[3,2],[2,3],[1,4],[0,5]],
                        [[4,0],[3,1],[2,2],[1,3]],[[3,1],[2,2],[1,3],[0,4]],
                        [[3,0],[2,1],[1,2],[0,3]]].to_a
        @board = [  [:zero,:one,:two,:three,:four,:five,:six],
                    [:zero,:one,:two,:three,:four,:five,:six],
                    [:zero,:one,:two,:three,:four,:five,:six],
                    [:zero,:one,:two,:three,:four,:five,:six],
                    [:zero,:one,:two,:three,:four,:five,:six],
                    [:zero,:one,:two,:three,:four,:five,:six]]
        @display = display
        @turn = first_player
        build_board
    end
    def build_board
        @slots = Array.new
        (1..7).each do |x|
            (1..6).each { |y| @slots << [x, y]}
        end
    end

    def display
        display = "Connect Four\n"
        code = "\u2610"
        @board.each do |sub_array|
           rowline = "|"
           sub_array.each { |row| row.is_a?(Symbol)? rowline << "#{code.encode('utf-8')}|": rowline << "#{row.encode('utf-8')}|"}
           display << rowline + "\n"
        end
        display.split("\n").each {|line| puts (line.encode('utf-8')).center(50)}
    end
    
    def drop_piece(column)
        overflow = true
        5.downto(0) do |row|
            next unless @board[row][column-1].is_a?(Symbol)
            @board[row][column-1] = @turn.symbol
            overflow = false
            break
        end
        overflow
    end
    
    def check_for_victory(player)
        victory = false
        victories.each do |sub_array|
            count = 0
            sub_array.each do |pos|
                count += 1 if @board[pos[1]][pos[0]] == player.symbol 
                victory = true if count == 4
            end
            next if victory == true
        end
        victory
    end
end